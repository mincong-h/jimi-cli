# Buy My House

This page describes how we leverage AI technologies and `jimi` CLI to analyse real-restate offers.

* **Design Plan.** Design a plan to evaluate a property in an interactive approach. The design is made by different LLMs (Claude 3.5 and ChatGPT 4), and then manually adjusted afterwards.
* **Extract Metadata.** Extract the metadata from different real-estate offers. It requires creating the definition of the schema that we want, and automatic extractions using [Vertesia AI](https://vertesiahq.com/).
* **Create Prompts.** Create prompts based on the initial plan and the offer metadata. Use those prompts to interact with the LLMs.
* **Generate analysis report.** Aggregate information from different interactions.

## Design Plan

Use Claude 3.5 Sonnet (<https://claude.ai/>) and ChatGPT 4o (<https://chatgpt.com/>) to design the plan of the analysis.

```
### Context ###
I want to buy a house in the greater Paris area. I want you to play the role of
a real-estate agent to assist me on real estate analysis. Keep in mind that I
am already an owner of a property and having several years of experience living
in this area. So don't afraid to use technical and specific terms and don't
assume that I am a beginner.

### Instruction ###
Assume that I have the description of the house, downloaded from a real estate
website, such as SeLoger or a local real-estate agency. I want you to assist me
in making decisions for deciding whether this house is a good candidate. Please
make a plan about the analysis. You don't need to perform actual analysis for
now, I just need a framework to iterate on actual content later on.

### Input Data ###
None

### Output Indicator ###
Group the output by different aspects of the purchase as "dimension". Describe
the definition of the dimension. Explain the interest of exploring this
dimension. Explain how can I find related information from the content of a
real estate offer. What additional information is required from me or from
other data sources is required to perform the analysis. Be creative if you
think other info should be included in the output.
```

Here is the plan generated by LLMs:

1. Financials
2. Property Characteristics
3. Location Intelligence
4. Legal and Administrative
5. Market Dynamics
6. Lifestyle and Fit
7. Risks and Downsides

### Financials

**Definition:** Comprehensive evaluation of the property's financial aspects and investment potential, including purchase price, taxes, and ongoing expenses.

**Interest:** Determines the property's value proposition and long-term financial viability. Ensures the property fits your budget and aligns with the market value to avoid overpaying.

**Information from listings:**

* Prix FAI (Frais d'Agence Inclus)
* Estimated annual property tax (taxe foncière)
* Copropriété charges

**Additional required information:**

* Your financing structure (cash, mortgage terms)
* Current market comparables (from DVF database)
* Historical price evolution in the neighborhood
* Potential rental yields if relevant
* Renovation costs or additional investment requirements

### Property Characteristics

**Definition:** Assessment of the property's structural integrity and technical specifications. The physical attributes of the house, including its size, layout, and features.

**Interest:** Evaluates maintenance requirements and potential renovation costs. Ensures the house meets your practical needs and aligns with market expectations for resale.

**Information from listings:**

* DPE rating
* Construction year
* Building materials
* Total living area (in square meters)
* Number and type of rooms (bedrooms, bathrooms, living spaces)
* Floor plan details (layout and orientation)
* Outdoor space (garden, balcony, terrace)
* Recent renovations or updates.

**Additional required information:**

* Full diagnostic report package
* Building permit history
* Copropriété meeting minutes (if applicable)
* Documentation of any recent works
* Verify the accuracy of square footage via floor plans or cadastral maps.
* Assess the structural condition (e.g., insulation, roofing).
* Evaluate compliance with modern building codes.

### Location Intelligence

**Definition:** Analysis of the property's geographical and infrastructural context. The geographic positioning of the house, its proximity to amenities, and the ease of accessing major transportation networks.

**Interest:** Evaluates long-term value drivers and quality of life aspects. Location directly impacts lifestyle, commute, and property value appreciation. Proximity to desirable areas or landmarks can make the property more attractive and maintain its value over time.

**Information from listings:**

* Neighborhood description
* Address or approximate location
* Distance to public transportation (e.g., metro, RER, bus)
* Proximity to schools, hospitals, supermarkets, and parks.

**Additional required required:**

* Grand Paris Express development timeline
* Local urban development plans (PLU)
* School district mapping
* Noise exposure plans (PEB)

### Legal and Administrative

**Definition:** Review of all legal aspects and administrative constraints.

**Interest:** Identifies potential roadblocks and future constraints. Avoid potential legal issues that could delay the purchase or devalue the property.

**Information from listings:**

* Property rights type (full ownership vs. co-op)
* Any legal disputes or liens on the property
* Urbanisme constraints
* Compliance with zoning laws and permits for existing structures.

**Additional required information:**

* Full notarial documentation
* Confirm no ongoing disputes with neighbors or co-owners
* Servitudes and easements
* Cadastral extracts
* PPRI (flood risk) zoning
* Check the minutes of recent HOA meetings for red flags

### Market Dynamics

**Definition:** Analysis of current and projected market conditions.

**Interest:** Positions the property within broader market trends. Helps gauge the property’s potential for appreciation and the likelihood of a favorable resale.

**Information from listings:**

* Time on market (indicating demand)
* Comparable properties' sale history

**Additional required information:**

* Transaction volume trends (study local supply and demand trends)
* Local market absorption rates
* Development pipeline in the area (research planned infrastructure improvements that may impact property value)
* Demographic trends
* Investigate historical price trends in the area

### Lifestyle and Fit

**Definition:** How well the property aligns with your personal and family needs.

**Interest:** Ensures the property supports your lifestyle preferences and long-term goals.

**Information to Extract from Listing:**

* Space suitability for current and future needs.
* Amenities that enhance quality of life (e.g., swimming pool, smart home features).
* Neighborhood culture and vibe.

**Additional Information Needed:**

* Evaluate your future plans (e.g., family expansion, remote work).
* Interview neighbors or visit the area at different times of day.

### Risks and Downsides

**Definition:** Potential challenges or negative aspects of the property.

**Interest:** Identifying red flags early helps avoid costly surprises after purchase.

**Information to Extract from Listing:**

* Any noted defects or repairs needed.
* Location-specific risks (e.g., flooding, subsidence).
* Mention of unusual terms or conditions in the sale.

**Additional Information Needed:**

* Commission a professional home inspection.
* Research environmental risks using government databases.
* Analyze the neighborhood’s long-term desirability.

## Extract Metadata

We rely on [Vertesia AI](https://vertesiahq.com/) to extract metadata from any real-estate offer to save time. The extraction requires the following steps:

1. Define the schema of a real-estate offer in Vertesia.
2. Upload the document and perform the automatic metadata extraction.

### Offer Schema

The offer schema is defined in this Git repository and upload to Vertesia. We don't rely on the editor of the platform because we need to put additional comments for each field to justify its presence. Also, because the schema is used for other logic in the `jimi` CLI.

Export the schema using the following command:

```sh
dist/jimi immo show-schema | jq '."$defs".Property'
```

```json
{
  "properties": {
    "name": {
      "type": "string"
    },
    "offer_url": {
      "type": "string"
    },
    "offer_description": {
      "type": "string"
    },
    "price": {
      "type": "number"
    },
    "annual_property_tax": {
      "type": "number"
    },
    "total_living_space_m2": {
      "type": "number"
    },
    "living_space_loi_carrez_m2": {
      "type": "number"
    },
    "land_surface_m2": {
      "type": "number"
    },
    "room_count": {
      "type": "integer"
    },
    "bedroom_count": {
      "type": "integer"
    },
    "wc_count": {
      "type": "integer"
    },
    "type": {
      "type": "string",
      "enum": [
        "house",
        "apartment"
      ]
    },
    "has_balcony": {
      "type": "boolean"
    },
    "has_garden": {
      "type": "boolean"
    },
    "has_terrace": {
      "type": "boolean"
    },
    "has_box": {
      "type": "boolean"
    },
    "has_garage": {
      "type": "boolean"
    },
    "construction_year": {
      "type": "integer"
    },
    "recent_renovations_or_updates": {
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "property_neighborhood": {
      "type": "string"
    },
    "property_address": {
      "type": "string"
    },
    "zip_code": {
      "type": "string"
    },
    "distance_by_walk_to_rer": {
      "type": "string"
    },
    "distance_by_walk_to_bus": {
      "type": "string"
    },
    "heating_system": {
      "type": "string"
    },
    "heating_type": {
      "type": "string"
    },
    "heating_method": {
      "type": "string"
    },
    "energy_performance_rating": {
      "type": "string"
    },
    "energy_greenhouse_gas_rating": {
      "type": "string"
    },
    "energy_consumption": {
      "type": "number"
    },
    "energy_ghg_emissions": {
      "type": "number"
    },
    "energy_estimated_annual_consumption": {
      "type": "string"
    },
    "agency_name": {
      "type": "string"
    },
    "agency_email": {
      "type": "string"
    },
    "agency_tel": {
      "type": "string"
    }
  },
  "additionalProperties": false,
  "type": "object",
  "required": [
    "name",
    "offer_url",
    "offer_description",
    "price",
    "total_living_space_m2",
    "living_space_loi_carrez_m2",
    "land_surface_m2",
    "room_count",
    "bedroom_count",
    "type",
    "zip_code",
    "heating_system",
    "heating_type",
    "heating_method",
    "energy_performance_rating",
    "energy_greenhouse_gas_rating"
  ]
}
```

> [!NOTE]
>
> * Different from JSON Schema, Vertesia does not support `enum` in their editor.
> * The generated metadata is immutable. Manual edits on an existing object is not supported. If you found any mistake, you need to delete the object, update the schema to provide better hint to Vertesia, and generate the content again.

### Extraction

* Export the offer from <https://seloger.com> as PDF, save it locally.
* Drag and drop the PDF into the "Content - Objects" view, select the content type "Real Estate Offer".
* Wait until the processing to be done, it may take tens of seconds.

## References

- [Introduction to Prompt Engineering | OpenAI Workshop](https://github.com/microsoft/OpenAIWorkshop/blob/main/scenarios/prompt_engineering/01_Prompt_Introduction.md)
- [Vertesia AI](https://vertesiahq.com/)
- [invopop/jsonschema | GitHub](https://github.com/invopop/jsonschema)
